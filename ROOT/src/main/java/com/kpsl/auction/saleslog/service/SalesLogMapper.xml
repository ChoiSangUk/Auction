<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kpsl.auction.saleslog.service.SalesLogMapper">
	<!-- select용 resultMap 만들어... -->
	<resultMap type="com.kpsl.auction.saleslog.vo.SalesLogVo" id="SalesLog">
		<id property="salesLogCode" column="sales_log_code" />
		<result property="salesLogRelationCode" column="sales_log_relation_code" />
		<result property="salesLogRelation" column="sales_log_relation" />
		<result property="salesLogDepositAndWithdrawal" column="sales_log_deposit_and_withdrawal" />
		<result property="salesLogUserId" column="sales_log_user_id" />
		<result property="salesLogPrice" column="sales_log_price" />
		<result property="salesLogDate" column="sales_log_date" />
		<result property="salesLogRemarks" column="sales_log_remarks" />
	</resultMap>

	<insert id="insertSalesLog" parameterType="com.kpsl.auction.saleslog.vo.SalesLogVo"
			useGeneratedKeys="true" keyProperty="sales_log_code">
		<selectKey keyProperty="cashCode" resultType="string"
			order="BEFORE">
			SELECT CONCAT("inout",MAX(CAST(substring(sales_log_code,6)+1 AS
			DECIMAL))) FROM sales_log_tb
		</selectKey>
		INSERT INTO sales_log_tb
		(sales_log_code, sales_log_relation_code, sales_log_relation,
		sales_log_deposit_and_withdrawal, sales_log_user_id, sales_log_price,
		sales_log_date, sales_log_remarks)
		VALUES (#{salesLogCode}, 'cash1', '캐쉬', '입금', 'id002', 5000, NOW(), '캐쉬충전');

	</insert>

<!-- INSERT INTO cash_tb
	(cash_code, user_id, cash_price, cash_date, cash_state)
	VALUES ('cash1', 'id002', 5000, NOW(), '충전');

INSERT INTO sales_log_tb
	(sales_log_code, sales_log_relation_code, sales_log_relation, sales_log_deposit_and_withdrawal, sales_log_user_id, sales_log_price, sales_log_date, sales_log_remarks)
	VALUES ('inout1', 'cash1', '캐쉬', '입금', 'id002', 5000, NOW(), '캐쉬충전');

UPDATE user_detail_tb
	SET user_totalcash = user_totalcash+5000
	WHERE user_id='id002';

 -->



</mapper>